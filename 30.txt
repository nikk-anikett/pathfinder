
var checkManual = true;
fetchData('database1');

var audioElement = document.getElementById("audio");
var playCheckbox = document.getElementById("playCheckbox");
var stopCheckbox = document.getElementById("stopCheckbox");
var showTableButton = document.getElementById("showTableButton"); // Get the button
var dataTable = document.getElementById("dataTable"); // Get the table

// ...

// Function to simulate a click on the playCheckbox
// ...

// Function to update the table with fetched data

function btnFunc_for_Manual(){
    let currentDatabase = 'database1';  
    if(checkManual == true){
      fetchData('database2');
      document.getElementById('myBtn').innerHTML='Manual OFF';
      checkManual = false;
    }else{
      fetchData('database1');
      document.getElementById('myBtn').innerHTML='Manual ON';
      checkManual = true;
    }
  }
// Load checkbox state from localStorage

// ...

// Show or hide the table based on button click
showTableButton.addEventListener("click", function() {
    dataTable.style.display = "table"; // Show the table
    fetchData(currentDatabase); // Fetch data and update the table
});

// ...

// Fetch data from server const visibilityState = {};
// Maintain a state object to keep track of visibility
const visibilityState = {};

function fetchData(database) {
    currentDatabase = database;
    const xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
            const data = JSON.parse(xhr.responseText);
            updateTable(data);
        }
    };
    xhr.open('GET', `/${database}`, true);
    xhr.send();
}

// Function to update the table with fetched data
function updateTable(data) {
    const tableBody = document.getElementById('data');
    let tableHTML = '';

    data.forEach((row) => {
        tableHTML += `<tr class="${row.Expirydate === '0' ? 'group-visible' : 'group-hidden'}" data-groupcode="${row.Groupcode}">
                        <td class="name">${row.FirstName}</td>
                        <td>${row.Symbol}</td>
                        <td>${row.Groupcode}</td>
                        <td>${row.Expirydate}</td>
                        <td>${row.Age}</td>
                        <td>${row.Now}</td>
                    </tr>`;
    });

    tableBody.innerHTML = tableHTML;

    const rows = document.querySelectorAll('tr[data-groupcode]');
    rows.forEach((row) => {
        const groupCode = row.getAttribute('data-groupcode');
        
        if (!(groupCode in visibilityState)) {
            visibilityState[groupCode] = false;
        }

        row.addEventListener('click', () => {
            visibilityState[groupCode] = !visibilityState[groupCode];
            updateRowVisibility(groupCode);
        });

        updateRowVisibility(groupCode);
    });
}

function updateRowVisibility(groupCode) {
    const rowsToToggle = document.querySelectorAll(`tr[data-groupcode="${groupCode}"]:not(.group-visible)`);

    rowsToToggle.forEach((toggleRow) => {
        toggleRow.style.display = visibilityState[groupCode] ? 'table-row' : 'none';
    });
}

// Include the updatePlayStatus() function to keep audio playback updated
fetchData(currentDatabase);
setInterval(() => {
    fetchData(currentDatabase);
    updatePlayStatus();
}, 2000); 

// function updateTable(data) {
//     const tableBody = document.getElementById('data');
//     let tableHTML = '';

//     data.forEach((row) => {
//         tableHTML += `<tr class="${row.Expirydate === '0' ? 'group-visible' : 'group-hidden'}" data-groupcode="${row.Groupcode}">
//                         <td class="name">${row.FirstName}</td>
//                         <td>${row.Symbol}</td>
//                         <td>${row.Groupcode}</td>
//                         <td>${row.Expirydate}</td>
//                         <td>${row.Age}</td>
//                         <td>${row.Now}</td>
//                     </tr>`;
//     });

//     tableBody.innerHTML = tableHTML;

//     const rows = document.querySelectorAll('tr[data-groupcode]');
//     rows.forEach((row) => {
//         row.addEventListener('click', () => {
//             const groupCode = row.getAttribute('data-groupcode');
//             const rowsToToggle = document.querySelectorAll(`tr[data-groupcode="${groupCode}"]:not(.group-visible)`);

//             rowsToToggle.forEach((toggleRow) => {
//                 toggleRow.classList.toggle('group-hidden');
//             });
//         });
//     });
// }







<!-- <!DOCTYPE html>
<html>
<head>
  <title>Fetch Data</title>
</head>
<body>
  <h1>Data Viewer</h1>
  <!-- <button onclick="btnFunc_for_Manual()" id="myBtn">manual on</button> -->
  <!-- <button onclick="fetchData('database2')">Fetch Data from Database 2</button> -->
  <!-- <audio id="audio" src="/CLICK.mp3" preload="auto"></audio>
    <label for="playCheckbox">Play Music:</label>
    <input type="checkbox" id="playCheckbox">
    <br>
    <label for="stopCheckbox">Stop Music:</label>
    <input type="checkbox" id="stopCheckbox">
  <table border="1">
    <thead>
      <tr>
        <th>First Name</th>
        <th>Expirydate</th>
        <th>Age</th>
        <th>Now</th>
      </tr>
    </thead>
    <tbody id="data"> -->
      <!-- Data will be displayed here dynamically -->
    <!--</tbody>
  </table>

  <script src="/client.js"></script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Display</title>
    <style>
      #dataTable {
        display: none;
      }
        .hidden {
            display: none;
        }
        .clickable-row {
            cursor: pointer;
        }
        .group-visible {
    display: table-row;
}

.group-hidden {
    display: none;
}


    </style>
</head>
<body>
    <audio id="audio" src="your-audio-file.mp3"></audio>
    <input type="checkbox" id="playCheckbox"> Play
    <input type="checkbox" id="stopCheckbox"> Stop
    <button id="myBtn" onclick="btnFunc_for_Manual()">Manual ON</button>
    <button id="showTableButton">Show Table</button>
    <table border="1" id="dataTable" style="display: none;" class="hidden"> 
        <thead>
            <tr>
                <th>FirstName</th>
                <th>Symbol</th>
                <th>Groupcode</th>
                <th>Expirydate</th>
                <th>Age</th>
                <th>Now</th>
            </tr>
        </thead>
        <tbody id="data">
            <!-- Data rows will be inserted here -->
        </tbody>
    </table>
    
    <script src="/client.js">
        // Your JavaScript code here
    </script>
</body>
</html>
